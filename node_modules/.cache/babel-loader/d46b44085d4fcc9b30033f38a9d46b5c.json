{"remainingRequest":"C:\\Users\\admin\\Desktop\\mySuperMall-master\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\admin\\Desktop\\mySuperMall-master\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\admin\\Desktop\\mySuperMall-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\admin\\Desktop\\mySuperMall-master\\src\\views\\detail\\Detail.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\admin\\Desktop\\mySuperMall-master\\src\\views\\detail\\Detail.vue","mtime":1650683489000},{"path":"C:\\Users\\admin\\Desktop\\mySuperMall-master\\babel.config.js","mtime":1650683489000},{"path":"C:\\Users\\admin\\Desktop\\mySuperMall-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1655424613910},{"path":"C:\\Users\\admin\\Desktop\\mySuperMall-master\\node_modules\\babel-loader\\lib\\index.js","mtime":1655424614063},{"path":"C:\\Users\\admin\\Desktop\\mySuperMall-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1655424613910},{"path":"C:\\Users\\admin\\Desktop\\mySuperMall-master\\node_modules\\vue-loader\\lib\\index.js","mtime":1655424613561}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.keys\";\nimport _defineProperty from \"C:/Users/admin/Desktop/mySuperMall-master/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport DetailNavBar from \"./DetailNavBar\";\nimport DetailSwiper from \"./DetailSwiper\";\nimport DetailBaseInfo from \"./DetailBaseInfo\";\nimport DetailShopInfo from \"./DetailShopInfo\";\nimport DetailGoodsInfo from \"./DetailGoodsInfo\";\nimport DetailParamsInfo from \"./DetailParamsInfo\";\nimport DetailCommentInfo from \"./DetailCommentInfo\";\nimport DetailBottomBar from \"./DetailBottomBar\";\nimport Scroll from \"../../components/common/scroll/Scroll\";\nimport GoodsList from \"../../components/content/goods/goodsList\";\nimport BackTop from \"../../components/content/backTop/BackTop\";\nimport Toast from \"../../components/common/toast/Toast\";\nimport { getDetail, getRecommend, Goods, GoodsParam, Shop } from \"../../network/detail\";\nimport { debounce } from \"../../common/utils\";\nimport { itemListener, backTopMinxin } from \"../../common/mixin\";\nimport { mapActions } from 'vuex';\nexport default {\n  name: \"Detail\",\n  data: function data() {\n    return {\n      iid: null,\n      topImages: [],\n      goods: {},\n      shop: {},\n      detailInfo: {},\n      paramInfo: {},\n      commentInfo: {},\n      recommends: [],\n      themeTopYs: [],\n      getThemeTopY: null,\n      currentIndex: 0,\n      isShowBackTop: true,\n      message: '',\n      show: false\n    };\n  },\n  mixins: [itemListener, backTopMinxin],\n  components: {\n    DetailNavBar: DetailNavBar,\n    DetailSwiper: DetailSwiper,\n    DetailBaseInfo: DetailBaseInfo,\n    DetailShopInfo: DetailShopInfo,\n    DetailGoodsInfo: DetailGoodsInfo,\n    DetailParamsInfo: DetailParamsInfo,\n    DetailCommentInfo: DetailCommentInfo,\n    DetailBottomBar: DetailBottomBar,\n    Scroll: Scroll,\n    GoodsList: GoodsList,\n    BackTop: BackTop,\n    Toast: Toast\n  },\n  created: function created() {\n    var _this = this;\n\n    //1保存传入的iid\n    this.iid = this.$route.params.iid; //2根据iid请求详情数据\n\n    getDetail(this.iid).then(function (res) {\n      var data = res.result; //获取顶部轮播图数据\n\n      _this.topImages = data.itemInfo.topImages; //获取商品信息\n\n      _this.goods = new Goods(data.itemInfo, data.columns, data.shopInfo.services); //获取店铺信息\n\n      _this.shop = new Shop(data.shopInfo); //    获取商品 详细信息\n\n      _this.detailInfo = data.detailInfo; //    保存参数信息\n\n      _this.paramInfo = new GoodsParam(data.itemParams.info, data.itemParams.rule); //    取出评论信息\n\n      if (data.rate.CRate !== 0) {\n        _this.commentInfo = data.rate.list[0];\n      }\n    }); //3、请求推荐数据\n\n    getRecommend().then(function (res) {\n      console.log(res);\n      _this.recommends = res.data.list;\n    }); //4、给getthemeTopY赋值(进行防抖）\n\n    this.getThemeTopY = debounce(function () {\n      _this.themeTopYs = [];\n\n      _this.themeTopYs.push(0);\n\n      _this.themeTopYs.push(_this.$refs.params.$el.offsetTop);\n\n      _this.themeTopYs.push(_this.$refs.comment.$el.offsetTop);\n\n      _this.themeTopYs.push(_this.$refs.recommend.$el.offsetTop);\n\n      console.log(_this.themeTopYs);\n    }, 500);\n  },\n  methods: _objectSpread(_objectSpread({\n    // 点击箭头回滚到顶部\n    backClick: function backClick() {\n      this.$refs.scroll.scrollTo(0, 0);\n    }\n  }, mapActions(['addCart'])), {}, {\n    imageLoad: function imageLoad() {\n      console.log('-----');\n      this.$refs.scroll.scroll.refresh(); // this.refresh();\n\n      this.getThemeTopY();\n    },\n    //点击导航栏scroll滑动到相应位置\n    titleClick: function titleClick(index) {\n      console.log(index);\n      this.$refs.scroll.scrollTo(0, -this.themeTopYs[index] + 44, 200);\n    },\n    //scroll滑动\n    contentScroll: function contentScroll(position) {\n      // console.log(position);\n      var positionY = -position.y + 44; //2、positionY与主题中的值进行对比\n      // [0, 13780, 15063, 15279,]\n      //positonY在0-13780之间 index = 0\n      //......\n      //positonY在15279之后 index = 3\n\n      for (var i = 0; i < this.themeTopYs.length; i++) {\n        //console.log(i); //str 下面 i+ 1会有问题\n        // if(positionY > this.themeTopYs[i] && positionY < this.themeTopYs[i + 1]) {\n        //\n        // }\n        var length = this.themeTopYs.length;\n\n        if (this.currentIndex !== i && (i < length - 1 && positionY >= this.themeTopYs[i] && positionY < this.themeTopYs[i + 1] || i === length - 1 && positionY >= this.themeTopYs[i])) {\n          //对于上面一长串的范围判断使用this.themeTopYs.push(Number.MAX.VALUE);\n          //这样可以省去 || 之后的判断代码\n          this.currentIndex = i;\n          console.log(this.currentIndex);\n          this.$refs.nav.currentIndex = this.currentIndex;\n        }\n      } //是否显示回到顶部\n\n\n      this.isShowBackTop = -position.y > 1000;\n    },\n    //添加到购物车\n    addToCart: function addToCart() {\n      var _this2 = this;\n\n      // console.log('addToCart');\n      //1、获取购物车需要展示的信息加入购物车\n      var product = {};\n      product.image = this.topImages[0];\n      product.title = this.goods.title;\n      product.desc = this.goods.desc;\n      product.price = this.goods.newPrice;\n      product.iid = this.iid;\n      product.realPrice = this.goods.realPrice; //2、将商品添加购物车里面\n      // this.$store.commit('addCart', product);\n      // this.$store.dispatch('addCart', product).then(res => {\n      //   console.log(res);\n      // });\n      //将上面 的方法影射到本组件内部(利用mapActions\n\n      this.addCart(product).then(function (res) {\n        console.log(res);\n        _this2.show = true;\n        _this2.message = res;\n        setTimeout(function () {\n          _this2.show = false;\n          _this2.message = '';\n        }, 1500); // console.log(this.$toast);\n        // this.$toast.show(res,2000);\n      });\n    }\n  })\n};",{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AAEA;AACAA,gBADA;AAEAC,MAFA,kBAEA;AACA;AACAC,eADA;AAEAC,mBAFA;AAGAC,eAHA;AAIAC,cAJA;AAKAC,oBALA;AAMAC,mBANA;AAOAC,qBAPA;AAQAC,oBARA;AAUAC,oBAVA;AAWAC,wBAXA;AAYAC,qBAZA;AAaAC,yBAbA;AAcAC,iBAdA;AAeAC;AAfA;AAiBA,GApBA;AAqBAC,uCArBA;AAsBAC;AACAC,8BADA;AAEAC,8BAFA;AAGAC,kCAHA;AAIAC,kCAJA;AAKAC,oCALA;AAMAC,sCANA;AAOAC,wCAPA;AAQAC,oCARA;AASAC,kBATA;AAUAC,wBAVA;AAWAC,oBAXA;AAYAC;AAZA,GAtBA;AAoCAC,SApCA,qBAoCA;AAAA;;AACA;AACA,sCAFA,CAGA;;AACAC;AACA,4BADA,CAEA;;AACA,gDAHA,CAIA;;AACA,mFALA,CAMA;;AACA,2CAPA,CAQA;;AACA,yCATA,CAUA;;AACA,mFAXA,CAYA;;AACA;AACA;AACA;AAEA,KAjBA,EAJA,CAsBA;;AACAC;AACAC;AACA;AACA,KAHA,EAvBA,CA4BA;;AACA;AACA;;AACA;;AACA;;AACA;;AACA;;AAEAA;AACA,KARA,EAQA,GARA;AAUA,GA3EA;AA4EAC;AACA;AACAC,aAFA,uBAEA;AACA;AACA;AAJA,KAMAC,uBANA;AAOAC,aAPA,uBAOA;AACAJ;AACA,yCAFA,CAGA;;AACA;AACA,KAZA;AAaA;AACAK,cAdA,sBAcAC,KAdA,EAcA;AACAN;AACA;AACA,KAjBA;AAkBA;AACAO,iBAnBA,yBAmBAC,QAnBA,EAmBA;AACA;AACA,uCAFA,CAIA;AACA;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,wCACAC,qDACAC,kCADA,IAEAD,mDAHA,GAGA;AACA;AACA;AACA;AACAT;AACA;AACA;AACA,OAzBA,CA2BA;;;AACA;AACA,KAhDA;AAiDA;AACAW,aAlDA,uBAkDA;AAAA;;AACA;AACA;AACA;AACAC;AACAA;AACAA;AACAA;AACAA;AACAA,+CATA,CAWA;AACA;AAEA;AACA;AACA;AAEA;;AACA;AACAZ;AACA;AACA;AAEAa;AACA;AACA;AACA,SAHA,EAGA,IAHA,EALA,CASA;AACA;AACA,OAXA;AAYA;AAjFA;AA5EA","names":["name","data","iid","topImages","goods","shop","detailInfo","paramInfo","commentInfo","recommends","themeTopYs","getThemeTopY","currentIndex","isShowBackTop","message","show","mixins","components","DetailNavBar","DetailSwiper","DetailBaseInfo","DetailShopInfo","DetailGoodsInfo","DetailParamsInfo","DetailCommentInfo","DetailBottomBar","Scroll","GoodsList","BackTop","Toast","created","getDetail","getRecommend","console","methods","backClick","mapActions","imageLoad","titleClick","index","contentScroll","position","i","positionY","addToCart","product","setTimeout"],"sourceRoot":"src/views/detail","sources":["Detail.vue"],"sourcesContent":["<template>\n    <div id=\"detail\">\n\n        <DetailNavBar @titleClick=\"titleClick\" class=\"detail-nav\" ref=\"nav\"></DetailNavBar>\n        <scroll :probe-type=\"3\" @scroll=\"contentScroll\" class=\"content\" ref=\"scroll\">\n            <DetailSwiper :topImages=\"topImages\"></DetailSwiper>\n            <DetailBaseInfo :goods=\"goods\"></DetailBaseInfo>\n            <DetailShopInfo :shop=\"shop\"></DetailShopInfo>\n            <DetailGoodsInfo :detailInfo=\"detailInfo\" @imageLoad=\"imageLoad\"></DetailGoodsInfo>\n            <DetailParamsInfo :paramInfo=\"paramInfo\" ref=\"params\"></DetailParamsInfo>\n            <DetailCommentInfo :commentInfo=\"commentInfo\" ref=\"comment\"></DetailCommentInfo>\n            <GoodsList :goods=\"recommends\" ref=\"recommend\"></GoodsList>\n        </scroll>\n        <!--底部导航栏-->\n        <DetailBottomBar @addCart=\"addToCart\"></DetailBottomBar>\n        <!-- 底部小火煎-->\n        <BackTop @click.native=\"backClick\" v-show=\"isShowBackTop\"></BackTop>\n        <!--toast组件封装成插件进行显示-->\n        <toast :message=\"message\" :is-show=\"show\"></toast>\n    </div>\n\n</template>\n\n<script>\n    import DetailNavBar from \"./DetailNavBar\"\n    import DetailSwiper from \"./DetailSwiper\"\n    import DetailBaseInfo from \"./DetailBaseInfo\"\n    import DetailShopInfo from \"./DetailShopInfo\"\n    import DetailGoodsInfo from \"./DetailGoodsInfo\"\n    import DetailParamsInfo from \"./DetailParamsInfo\"\n    import DetailCommentInfo from \"./DetailCommentInfo\";\n    import DetailBottomBar from \"./DetailBottomBar\";\n\n    import Scroll from \"../../components/common/scroll/Scroll\";\n    import GoodsList from \"../../components/content/goods/goodsList\";\n    import BackTop from \"../../components/content/backTop/BackTop\";\n    import Toast from \"../../components/common/toast/Toast\";\n\n    import {getDetail, getRecommend, Goods, GoodsParam, Shop} from \"../../network/detail\";\n    import {debounce} from \"../../common/utils\";\n    import {itemListener, backTopMinxin} from \"../../common/mixin\";\n\n    import {mapActions} from 'vuex';\n\n    export default {\n        name: \"Detail\",\n        data() {\n            return {\n                iid: null,\n                topImages: [],\n                goods: {},\n                shop: {},\n                detailInfo: {},\n                paramInfo: {},\n                commentInfo: {},\n                recommends: [],\n\n                themeTopYs: [],\n                getThemeTopY: null,\n                currentIndex: 0,\n                isShowBackTop: true,\n                message: '',\n                show: false\n            }\n        },\n        mixins: [itemListener, backTopMinxin],\n        components: {\n            DetailNavBar,\n            DetailSwiper,\n            DetailBaseInfo,\n            DetailShopInfo,\n            DetailGoodsInfo,\n            DetailParamsInfo,\n            DetailCommentInfo,\n            DetailBottomBar,\n            Scroll,\n            GoodsList,\n            BackTop,\n            Toast\n        },\n        created() {\n            //1保存传入的iid\n            this.iid = this.$route.params.iid;\n            //2根据iid请求详情数据\n            getDetail(this.iid).then(res => {\n                const data = res.result;\n                //获取顶部轮播图数据\n                this.topImages = data.itemInfo.topImages;\n                //获取商品信息\n                this.goods = new Goods(data.itemInfo, data.columns, data.shopInfo.services);\n                //获取店铺信息\n                this.shop = new Shop(data.shopInfo);\n                //    获取商品 详细信息\n                this.detailInfo = data.detailInfo;\n                //    保存参数信息\n                this.paramInfo = new GoodsParam(data.itemParams.info, data.itemParams.rule);\n                //    取出评论信息\n                if (data.rate.CRate !== 0) {\n                    this.commentInfo = data.rate.list[0]\n                }\n\n            })\n            //3、请求推荐数据\n            getRecommend().then(res => {\n                console.log(res);\n                this.recommends = res.data.list;\n            });\n\n            //4、给getthemeTopY赋值(进行防抖）\n            this.getThemeTopY = debounce(() => {\n                this.themeTopYs = [];\n                this.themeTopYs.push(0);\n                this.themeTopYs.push(this.$refs.params.$el.offsetTop);\n                this.themeTopYs.push(this.$refs.comment.$el.offsetTop);\n                this.themeTopYs.push(this.$refs.recommend.$el.offsetTop);\n\n                console.log(this.themeTopYs);\n            }, 500);\n\n        },\n        methods: {\n            // 点击箭头回滚到顶部\n            backClick() {\n                this.$refs.scroll.scrollTo(0, 0)\n            },\n            //可以使用对象方式 'add':'addCart'\n            ...mapActions(['addCart']),\n            imageLoad() {\n                console.log('-----');\n                this.$refs.scroll.scroll.refresh();\n                // this.refresh();\n                this.getThemeTopY();\n            },\n            //点击导航栏scroll滑动到相应位置\n            titleClick(index) {\n                console.log(index);\n                this.$refs.scroll.scrollTo(0, -this.themeTopYs[index] + 44, 200);\n            },\n            //scroll滑动\n            contentScroll(position) {\n                // console.log(position);\n                const positionY = -position.y + 44;\n\n                //2、positionY与主题中的值进行对比\n                // [0, 13780, 15063, 15279,]\n                //positonY在0-13780之间 index = 0\n                //......\n                //positonY在15279之后 index = 3\n                for (let i = 0; i < this.themeTopYs.length; i++) {\n                    //console.log(i); //str 下面 i+ 1会有问题\n                    // if(positionY > this.themeTopYs[i] && positionY < this.themeTopYs[i + 1]) {\n                    //\n                    // }\n                    let length = this.themeTopYs.length;\n                    if (this.currentIndex !== i\n                        && ((i < length - 1 && positionY >= this.themeTopYs[i]\n                            && positionY < this.themeTopYs[i + 1])\n                            || (i === length - 1 && positionY >= this.themeTopYs[i]))) {\n                        //对于上面一长串的范围判断使用this.themeTopYs.push(Number.MAX.VALUE);\n                        //这样可以省去 || 之后的判断代码\n                        this.currentIndex = i;\n                        console.log(this.currentIndex);\n                        this.$refs.nav.currentIndex = this.currentIndex;\n                    }\n                }\n\n                //是否显示回到顶部\n                this.isShowBackTop = (-position.y) > 1000;\n            },\n            //添加到购物车\n            addToCart(){\n                // console.log('addToCart');\n                //1、获取购物车需要展示的信息加入购物车\n                const product = {};\n                product.image = this.topImages[0];\n                product.title = this.goods.title;\n                product.desc = this.goods.desc;\n                product.price = this.goods.newPrice;\n                product.iid = this.iid;\n                product.realPrice = this.goods.realPrice;\n\n                //2、将商品添加购物车里面\n                // this.$store.commit('addCart', product);\n\n                // this.$store.dispatch('addCart', product).then(res => {\n                //   console.log(res);\n                // });\n\n                //将上面 的方法影射到本组件内部(利用mapActions\n                this.addCart(product).then(res => {\n                    console.log(res);\n                    this.show = true;\n                    this.message = res;\n\n                    setTimeout(() => {\n                      this.show = false;\n                      this.message = '';\n                    }, 1500);\n                    // console.log(this.$toast);\n                    // this.$toast.show(res,2000);\n                })\n            }\n        }\n\n\n    }\n</script>\n\n<style scoped>\n    #detail {\n        position: relative;\n        z-index: 9;\n        background-color: #fff;\n        height: 100vh;\n    }\n\n    .detail-nav {\n        position: relative;\n        z-index: 9;\n        background-color: #fff;\n    }\n\n    .content {\n        background-color: #fff;\n        height: calc(100% - 44px - 49px);\n    }\n\n    /*.content {*/\n    /*    background-color: #fff;*/\n    /*    height: calc(100% - 44px - 49px);*/\n    /*}*/\n</style>\n"]}]}